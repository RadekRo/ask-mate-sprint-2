{% extends "layout.html" %}
{% block content %}
<a href="/list" class="btn btn-light btn-sm mb-4" role="button">
    <i class="fa-solid fa-circle-arrow-left"></i> Back to All Questions
</a>
<div class="container">
    <div class="questions-list">
        <span class="questions-list-header"><h4>{{question.title}}</h4>
        <h7><i class="fa-regular fa-calendar-days"></i> {{question.submission_time}} <br/><i class="fa-regular fa-eye"></i> {{question.view_number}}</h7>
        </span>
        <form action="/ask-question">
            <span><button type="submit" class="btn btn-primary">Ask Question</button></span>
        </form>
    </div>
</div>
<div class="container">
    <i class="fa-solid fa-ellipsis-vertical mx-1"></i>
    <a href="{{ url_for('edit_question', id=question[0])}}" class="btn btn-success btn-sm" role="button">Edit</a>
    <a href="{{ url_for('delete_question', id=question.id)}}" class="btn btn-danger btn-sm" role="button">Delete</a>
</div>
<div class="container border-top my-2 py-2">
    {{question.message}}
</div>
{% if question.image != 'no-image' %}
<div class="container">
    <img class="pictures" src="/{{question.image}}" alt="question's image file" />
</div>
{% endif %}
<div class="container mt-3">
    {% for tag in tags %}
        <div class="tag rounded px-2">#{{tag.name}} <a href="/question/{{question.id}}/tag/{{tag['id']}}/delete" class="text-danger text-decoration-none ms-2"><b>x</b></a></div>
    {% endfor %}
</div>
{% for comment in comments_question %}
    <div class="container border-top px-5 py-2 comment-message">
        {{ comment.message }} - <span class="text-info">{{comment.submission_time}}</span>
    </div>
{% endfor %}
<div class="container text-info border-bottom py-2">
    <a href="{{ url_for('add_comment_question', id=question.id)}}" class="text-decoration-none link-info"><i class="fa-regular fa-comment"></i> Add a comment</a>
</div>
<!--<div class="container border-top my-2 py-2">
    <span class="text-secondary me-2"><b>Question Score:</b> </span><a href="" class="text-decoration-none text-danger"><i class="fa-solid fa-square-minus"></i></a>
    <span class="text-secondary mx-1">{{question.vote_number}}</span> <a href="" class="text-decoration-none text-success"><i class="fa-solid fa-square-plus"></i></a>
</div>-->
<!-- <div class="container my-3">
    <i class="fa-solid fa-ellipsis-vertical me-2"></i>
    <a href="{{ url_for('edit_question', id=question[0])}}" class="btn btn-success btn-sm" role="button">Edit Question</a>
    <a href="{{ url_for('delete_question', id=question.id)}}" class="btn btn-danger btn-sm" role="button">Delete Question</a>
</div> -->
<div class="container bg-light py-2">
    <h5>{{ answers|length }} Answers</h5>
</div>

<div class="question-list row">
    <b class="question-title">{{question.title}}</b>
    <div class="question-txt">
        <p class="txt" >{{question.message}}</p>
        {% if question.image != 'no-image' %}
            <div class="container">
                <img class="pictures" src="/{{question.image}}" style="max-width: 150px"/>
            </div>
        {% endif %}
        <a class="add-answer" href="{{ url_for('route_answer', id=question.id)}}">Add new answer</a><br/><br/>
        <p class="vote-question">Number of votes already for this question: {{question.vote_number}}</p><br/><br/>
        <div class="del-edit">
            <a class="delete" href="{{ url_for('delete_question', id=question.id)}}">DELETE QUESTION</a><br/>
            <a class="edit" href="{{ url_for('edit_question', id=question[0])}}">EDIT QUESTION</a><br /><br/>
        </div>
        <div class="question-list">
            <a href="{{ url_for('add_tag', question_id=question.id)}}">ADD QUESTION TAG</a><br/>
            <span>Current tags: </span>
            {% for tag in tags %}
                <span>{{tag['name']}} <a href="/question/{{question.id}}/tag/{{tag['id']}}/delete"><b>x</b></a></span>
            {% endfor %}
        </div>
        <div>
            <b class="comment-title">COMMENTS TO QUESTION</b><br/>
        {% for comment in comments_question %}  
            <p class="comment">
                Submitted: {{comment.submission_time}}<br/>
                {{comment.message}}<a href="delete_comment"><img src="/static/images/recycle_bin_icon.png" alt="Delete comment" width="50" height="50"/></a><br/>
            </p>
        {% endfor %} 
            <a class="add-new-comment" href="{{ url_for('add_comment_question', id=question.id)}}">Add your comment to this question</a><br/><br/>
        </div>
        </div>
</div>
<div class="question-list row">
    <br />
    <b class="answer-title">ANSWERS</b><br/>
    {% for answer in answers %}
        <p class="answer">
            <a class="delete-answer" href="{{ url_for('show_answer',answer_id=answer.id)}}">{{answer.message}}</a><br/><br/>
        {% if answer.image != "no-image" %}
                <br/>
                <img src="/{{answer.image}}" style="max-width: 200px"/>
        {% endif %}
        <b class="comment-title-answer">COMMENTS TO ANSWER</b><br/>
        {% for comment in comments_answer %}
            {% if comment.answer_id == answer.id %}
                Submitted: {{comment.submission_time}}<br/>
                {{comment.message}}<a href="{{ url_for('route_delete_comment', comment_id=comment.id, id=question.id)}}"><img src="/static/images/recycle_bin_icon.png" alt="Delete comment" width="50" height="50" /></a><br/><br/><br/><br/>              
                <a class="add-new-comment-answer" href="{{ url_for('route_edit_comment', comment_id=comment.id, id=question.id)}}">Edit comment</a><br/><br/><br/>
                Edited {{comment.edited_number}} times.<br/>
                {% endif %}
        {% endfor %}
            <a class="add-new-comment-answer" href="{{ url_for('route_comment_answer', answer_id=answer.id, id=question.id)}}">Add your comment to this answer</a><br/><br/>
            <div class="buttons">
            <form method="post" action="{{ url_for('route_answer_add_vote', answer_id=answer.id)}}">
            <button class="plus" type="submit">+</button>
            <input type="hidden" name="id" value={{question.id}}></form>
            <form method="post" action="{{ url_for('route_answer_substract_vote', answer_id=answer.id)}}">
            <button class="minus" type="submit">-</button>
            <input type="hidden" name="id" value={{question.id}}></form>
            </div>
            <br/><center>Number of votes already for this answer: <b>{{answer.vote_number}}</b> </center><br/>
            <a class="delete-answer" href="{{ url_for('delete_answer',id=answer.id,ids=question.id)}}">DELETE ANSWER</a>
        </p>
    {% endfor %}
</div>

{% endblock %}